@page "/login"
@using HRIS.Shared.Models.Users
@using HRIS.Web.Services.Contracts
@using HRIS.Web.Components.Validations

@layout EmptyLayout

<MudThemeProvider />
<MudPopoverProvider />
<MudDialogProvider />
<MudSnackbarProvider />

<MudContainer MaxWidth="MaxWidth.Small">
    <EditForm Model="_login" OnValidSubmit="HandleLoginAsync">
        <FluentValidationValidator T="LoginUserDto" />
        <MudGrid>
            <MudItem xs="12">
                <MudTextField Label="Username of Email"
                              @bind-Value="_login.UsernameOrEmailAddress" For="@(() => _login.UsernameOrEmailAddress)"
                              Variant="Variant.Outlined"/>
            </MudItem>
            <MudItem xs="12">
                <MudTextField Label="Password"
                              @bind-Value="_login.Password" For="@(() => _login.Password)"
                              InputType="InputType.Password" Variant="Variant.Outlined"/>
            </MudItem>
            <MudItem xs="12">
                <MudButton ButtonType="ButtonType.Submit" Variant="Variant.Filled" Color="Color.Primary" FullWidth="true">
                    Login
                </MudButton>
            </MudItem>
        </MudGrid>
    </EditForm>
</MudContainer>

@code {
    [Inject] public IAuthenticationService AuthenticationService { get; set; }
    
    private LoginUserDto _login = new();

    private async Task HandleLoginAsync() => await AuthenticationService.LoginAsync(_login);
}